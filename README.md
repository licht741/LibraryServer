# LibraryServer

## Уровень базы данных

### Таблицы
* **BOOKSLIST** - Список всех зарегистрированных в базе книг (с указанием названия, автора, издательства, года издания)
* **BOOKS_IN_LIBRARY** - Перечень книг, находящихся в наличии, с указанием их количества
* **BOOKS_ORDER** - Пользовательские заказы на книги
* **BOOK_OPERATIONS** - Таблица, в которой хранятся записи о взятых читателями книгах
* **BOOK_STORES** - Перечень поставщиков книг
* **PURCHASE_BOOK** - Список приобретений библиотекой книг (с указанием поставщика, даты покупки и количества). Предполагается, что оплата книг производится внешней структурой, поэтому стоимость покупок в системе не учитывается
* **USERS** - Общий список пользователей библиотеки (писателей и читателей)

### Процедуры
*  **AUTHORIZATION** - Авторизация пользователя в системе, с указанием логина, пароля и типа пользователя (читатель/библиотекарь). Возвращает целочисленный год авторизации и дополнительные данные о пользователе
*  **EXTEND_USAGE** - Процедура, вызываемая читателем. Переносит крайний срок сдачи книги на 2 недели. Если на книгу есть заказ в BOOKS_ORDER, продление запрещается
*  **FIND_DEBTORS** - Возвращает список должников (читателей, у которых есть невозвращенные книги с пропущенным дедлайном)
*  **GET_AVAILABLE_BOOKS** - Возвращает список книг, доступных читателю (имеющихся в наличии в библиотеке)
*  **GET_BOOKS_IN_LIBRARY** - Возвращает список книг, содержащихся в библиотеке, с указанием их количества
*  **GET_BOOK_OPERATIONS** - Возвращает список записей о невозвращенных книгах
*  **GET_PURCHASE_ORDERS** - Возвращает список книжных поставок в библиотеку
*  **GET_USERS_BOOKS** - Возвращает список невозвращенных книг для указанного пользователя
*  **GET_USERS_ORDER** - Возвращает список книг, заказанных пользователями
*  **LIBRARIAN_REGISTRATION** - Регистрация пользователя с указанными данными. Данные обязательно должны быть не пусты, а логин - уникален
*  **LOCK_DEBTOR** - Блокировка читателя с пропущенным дедлайном
*  **MAKE_ORDER** - Оформление читательского заказа на книгу 
*  **RECEIPT_BOOKS** - Приобретение библиотекой книг в указанном количестве от указанного поставщика
*  **RETURN_BOOK** - Закрывает запись о невозвращенной книге
*  **TAKE_BOOK** - Получение книги из библиотеки
*  **UNLOCK_DEBTOR** - разблокировка указанного пользователя

### Триггеры
Триггеры используются для генерации первичных ключей и проверки корректности поступающих данных

## Уровень сервера

*  **connector.DatabaseConnector** - Инкапсулирует логику подключения к БД и выдачи соединения по запросу. Реализуется через паттерн Singleton
  
*  **dbwrappers.LibrarianWrapper** - Обёртка над базой данных для клиента-библиотекаря
*  **dbwrappers.ReaderWrapper** - Обёртка над базой данных для клиента-читателя

*  **creators.ObjectCreator** - Класс со статическими методами для создания объектов и их инициализации

* **types** - Классы-обёртки над поступающими из БД данными
  
*  **endpoint.ReaderService** - Представляет веб-методы для клиента-читателя
*  **endpoint.LibrarianService** - Представляет веб-методы для клиента-библиотекаря
  
*  **MainServerApp** - Создаёт экземпляры веб сервисов и паблишит их на указанные адреса
